<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Vedic Astrology Chart Builder</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Crimson+Pro:wght@400;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #fdfcf0;
  --surface: #ffffff;
  --border: #d4af37;
  --gold: #b8860b;
  --accent: #1a5fb4;
  --text: #1a1a1a;
  --sun: #ff9800; --moon: #9e9e9e; --mars: #f44336;
  --mercury: #4caf50; --jupiter: #ffc107; --venus: #e91e63;
  --saturn: #3f51b5; --rahu: #607d8b; --ketu: #795548;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  background: var(--bg);
  color: var(--text);
  font-family: 'Crimson Pro', serif;
  padding: 15px;
  display: flex;
  flex-direction: column;
  align-items: center;
  overflow-x: hidden;
}

.app-header { text-align: center; margin-bottom: 15px; }
.app-title { font-family: 'Cinzel', serif; color: var(--gold); font-size: 1.4rem; }

.chart-wrap {
  width: 100%;
  max-width: 500px;
  background: var(--surface);
  border: 3px solid var(--border);
  border-radius: 12px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.1);
}

.chart-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  grid-template-rows: repeat(4, 85px);
  gap: 2px;
  background: var(--border);
  grid-template-areas:
    "pisces  aries   taurus  gemini"
    "aquarius center center  cancer"
    "capricorn center center leo"
    "sagittarius scorpio libra virgo";
}

.cell {
  background: #fffdf5;
  position: relative;
  display: flex;
  flex-wrap: wrap;
  align-content: flex-start;
  justify-content: center;
  padding: 18px 2px 2px 2px;
  gap: 2px;
}

.cell[data-sign="Pisces"]      { grid-area: pisces; }
.cell[data-sign="Aries"]       { grid-area: aries; }
.cell[data-sign="Taurus"]      { grid-area: taurus; }
.cell[data-sign="Gemini"]      { grid-area: gemini; }
.cell[data-sign="Aquarius"]    { grid-area: aquarius; }
.cell[data-sign="Cancer"]      { grid-area: cancer; }
.cell[data-sign="Capricorn"]   { grid-area: capricorn; }
.cell[data-sign="Leo"]         { grid-area: leo; }
.cell[data-sign="Sagittarius"] { grid-area: sagittarius; }
.cell[data-sign="Scorpio"]     { grid-area: scorpio; }
.cell[data-sign="Libra"]       { grid-area: libra; }
.cell[data-sign="Virgo"]       { grid-area: virgo; }

.cell-center {
  grid-area: center;
  background: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-family: 'Cinzel', serif;
  color: var(--border);
  font-size: 0.8rem;
  letter-spacing: 2px;
}

.sign-label {
  position: absolute;
  top: 2px; left: 4px;
  font-size: 0.65rem;
  font-weight: bold;
  color: var(--gold);
}

.house-num {
  position: absolute;
  bottom: 2px; right: 4px;
  font-size: 0.65rem;
  color: var(--accent);
}

/* Planet Chips */
.planet {
  padding: 4px 6px;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: bold;
  color: white;
  cursor: grab;
  user-select: none;
  touch-action: none;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.planet.Lagna { background: #fff; color: var(--gold); border: 2px solid var(--gold); }
.planet.Sun { background: var(--sun); } .planet.Moon { background: var(--moon); }
.planet.Mars { background: var(--mars); } .planet.Mercury { background: var(--mercury); }
.planet.Jupiter { background: var(--jupiter); } .planet.Venus { background: var(--venus); }
.planet.Saturn { background: var(--saturn); } .planet.Rahu { background: var(--rahu); }
.planet.Ketu { background: var(--ketu); }

.bank-panel {
  width: 100%;
  max-width: 500px;
  margin-top: 15px;
  background: white;
  padding: 15px;
  border-radius: 12px;
  border: 1px solid var(--border);
}

.planet-bank {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  justify-content: center;
  padding: 10px;
  background: #f9f9f9;
  border-radius: 8px;
  min-height: 50px;
}

.controls {
  display: flex;
  gap: 10px;
  margin-top: 15px;
  justify-content: center;
}

.btn {
  padding: 10px 15px;
  border: none;
  border-radius: 6px;
  background: var(--accent);
  color: white;
  font-family: 'Cinzel', serif;
  font-size: 0.7rem;
  cursor: pointer;
}

.btn.danger { background: var(--mars); }

#prompt-area {
  width: 100%;
  max-width: 500px;
  margin-top: 15px;
}

textarea {
  width: 100%;
  height: 120px;
  border-radius: 8px;
  border: 1px solid var(--border);
  padding: 10px;
  font-family: inherit;
  font-size: 0.85rem;
  resize: none;
}

#drag-ghost {
  position: fixed;
  pointer-events: none;
  z-index: 1000;
  display: none;
  opacity: 0.8;
}

@media (max-width: 400px) {
  .chart-grid { grid-template-rows: repeat(4, 70px); }
  .planet { font-size: 0.65rem; padding: 3px 5px; }
}
</style>
</head>
<body>

<div id="drag-ghost"></div>

<div class="app-header">
  <h1 class="app-title">Vedic Chart Builder</h1>
</div>

<div class="chart-wrap">
  <div class="chart-grid" id="chartGrid">
    <div class="cell" data-sign="Pisces"><span class="sign-label">Pi</span><span class="house-num"></span></div>
    <div class="cell" data-sign="Aries"><span class="sign-label">Ar</span><span class="house-num"></span></div>
    <div class="cell" data-sign="Taurus"><span class="sign-label">Ta</span><span class="house-num"></span></div>
    <div class="cell" data-sign="Gemini"><span class="sign-label">Ge</span><span class="house-num"></span></div>
    <div class="cell" data-sign="Aquarius"><span class="sign-label">Aq</span><span class="house-num"></span></div>
    <div class="cell-center">SOUTH INDIAN<br>CHART</div>
    <div class="cell" data-sign="Cancer"><span class="sign-label">Cn</span><span class="house-num"></span></div>
    <div class="cell" data-sign="Capricorn"><span class="sign-label">Cp</span><span class="house-num"></span></div>
    <div class="cell" data-sign="Leo"><span class="sign-label">Le</span><span class="house-num"></span></div>
    <div class="cell" data-sign="Sagittarius"><span class="sign-label">Sg</span><span class="house-num"></span></div>
    <div class="cell" data-sign="Scorpio"><span class="sign-label">Sc</span><span class="house-num"></span></div>
    <div class="cell" data-sign="Libra"><span class="sign-label">Li</span><span class="house-num"></span></div>
    <div class="cell" data-sign="Virgo"><span class="sign-label">Vi</span><span class="house-num"></span></div>
  </div>
</div>

<div class="bank-panel">
  <div class="planet-bank" id="planetBank">
    <div class="planet Lagna" data-pid="Lagna">Lagna</div>
    <div class="planet Sun" data-pid="Sun">Sun</div>
    <div class="planet Moon" data-pid="Moon">Moon</div>
    <div class="planet Mars" data-pid="Mars">Mars</div>
    <div class="planet Mercury" data-pid="Mercury">Merc</div>
    <div class="planet Jupiter" data-pid="Jupiter">Jup</div>
    <div class="planet Venus" data-pid="Venus">Ven</div>
    <div class="planet Saturn" data-pid="Saturn">Sat</div>
    <div class="planet Rahu" data-pid="Rahu">Rahu</div>
    <div class="planet Ketu" data-pid="Ketu">Ketu</div>
  </div>

  <div class="controls">
    <button class="btn" onclick="generatePrompt()">Generate Prompt</button>
    <button class="btn danger" onclick="clearChart()">Clear</button>
  </div>
</div>

<div id="prompt-area">
  <textarea id="promptOutput" placeholder="Place planets to generate AI prompt..."></textarea>
</div>

<script>
const SIGNS = ["Aries","Taurus","Gemini","Cancer","Leo","Virgo","Libra","Scorpio","Sagittarius","Capricorn","Aquarius","Pisces"];
let planetData = {}; 
let lagnaSign = null;

// Drag and Drop Logic
let activeDrag = null;
const ghost = document.getElementById('drag-ghost');

document.addEventListener('pointerdown', e => {
  const el = e.target.closest('.planet');
  if (!el) return;
  activeDrag = { el, pid: el.dataset.pid, startX: e.clientX, startY: e.clientY };
  el.style.opacity = '0.4';
});

document.addEventListener('pointermove', e => {
  if (!activeDrag) return;
  ghost.style.display = 'block';
  ghost.innerHTML = activeDrag.el.outerHTML;
  ghost.style.left = (e.clientX - 20) + 'px';
  ghost.style.top = (e.clientY - 15) + 'px';
});

document.addEventListener('pointerup', e => {
  if (!activeDrag) return;
  ghost.style.display = 'none';
  activeDrag.el.style.opacity = '1';

  const target = document.elementFromPoint(e.clientX, e.clientY)?.closest('.cell');
  const bank = document.elementFromPoint(e.clientX, e.clientY)?.closest('#planetBank');

  if (target) {
    target.appendChild(activeDrag.el);
    planetData[activeDrag.pid] = target.dataset.sign;
    if (activeDrag.pid === 'Lagna') {
      lagnaSign = target.dataset.sign;
      updateHouses();
    }
  } else if (bank || !target) {
    document.getElementById('planetBank').appendChild(activeDrag.el);
    delete planetData[activeDrag.pid];
    if (activeDrag.pid === 'Lagna') {
      lagnaSign = null;
      updateHouses();
    }
  }
  activeDrag = null;
});

function updateHouses() {
  document.querySelectorAll('.cell').forEach(cell => {
    const numEl = cell.querySelector('.house-num');
    if (!lagnaSign) {
      numEl.innerText = '';
      return;
    }
    const lIdx = SIGNS.indexOf(lagnaSign);
    const sIdx = SIGNS.indexOf(cell.dataset.sign);
    const hNum = (sIdx - lIdx + 12) % 12 + 1;
    numEl.innerText = hNum;
  });
}

function generatePrompt() {
  let text = "Analyze this Vedic Astrology Chart:\n";
  text += `Lagna: ${lagnaSign || 'Not Set'}\n`;
  for (let p in planetData) {
    if (p !== 'Lagna') text += `${p}: ${planetData[p]}\n`;
  }
  document.getElementById('promptOutput').value = text + "\nPlease provide a detailed reading based on these placements.";
}

function clearChart() {
  const bank = document.getElementById('planetBank');
  document.querySelectorAll('.planet').forEach(p => bank.appendChild(p));
  planetData = {};
  lagnaSign = null;
  updateHouses();
  document.getElementById('promptOutput').value = '';
}
</script>

</body>
</html>
